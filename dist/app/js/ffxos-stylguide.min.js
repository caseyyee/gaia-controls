"use strict";if(navigator.mozApps){var checkIfInstalled=navigator.mozApps.getSelf();checkIfInstalled.onsuccess=function(){if(checkIfInstalled.result){var a=document.querySelector("#installation-instructions");a&&(a.style.display="none")}else{var b=document.querySelector("#install"),c=location.href.substring(0,location.href.lastIndexOf("/"))+"/manifest.webapp";b.onclick=function(){var a=navigator.mozApps.install(c);a.onsuccess=function(){b.style.display="none"},a.onerror=function(){alert("Install failed\n\n:"+a.error.name)}}}}}else console.log("Open Web Apps not supported");var reload=document.querySelector("#reload");reload&&(reload.onclick=function(){location.reload(!0)});for(var toggles=document.querySelectorAll(".toggle"),i=0;i<toggles.length;i++){var toggleElem=toggles[i];toggleElem.addEventListener("click",function(){this.classList.toggle("is-checked")})}!function(a){function b(a){F>=2&&console.log("[l10n] "+a)}function c(a){F&&console.warn("[l10n] "+a)}function d(a,b){var c=a.length;if(c&&F){for(var d=[],e=0;c>e;e++){var f=a[e].getAttribute("data-l10n-id");d.indexOf(f)<0&&d.push(f)}console.warn("[l10n] "+d.length+" missing key(s) for ["+b+"]: "+d.join(", "))}}function e(){return document.querySelectorAll('link[type="application/l10n"]')}function f(a){var b=function(a){var b='script[type="application/l10n"][lang="'+a+'"]';return document.querySelector(b)},c=b(a)||b(D);return c?JSON.parse(c.innerHTML):null}function g(a){return a?a.querySelectorAll("*[data-l10n-id]"):[]}function h(a){if(!a)return{};var b=a.getAttribute("data-l10n-id"),d=a.getAttribute("data-l10n-args"),e={};if(d)try{e=JSON.parse(d)}catch(f){c("could not parse arguments for #"+b)}return{id:b,args:e}}function i(a,b){if(!a.firstElementChild)return void(a.textContent=b);for(var c=!1,d=/\S/,e=a.firstChild;e;e=e.nextSibling)3===e.nodeType&&d.test(e.nodeValue)&&(c?e.nodeValue="":(e.nodeValue=b,c=!0));c||a.insertBefore(document.createTextNode(b),a.firstChild)}function j(){var b=document.createEvent("Event");b.initEvent("localized",!1,!1),b.language=z,a.dispatchEvent(b)}function k(a,b,d,e){function f(a){return a.lastIndexOf("\\")<0?a:a.replace(/\\\\/g,"\\").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'")}function g(a){function c(a,c){for(var h=a.replace(g,"").split(/[\r\n]+/),p="*",q=b.replace(/-[a-z]+$/i,""),r=!1,s="",t=0;t<h.length;t++){var u=h[t];if(!j.test(u)){for(;o.test(u)&&t<h.length;)u=u.slice(0,u.length-1)+h[++t].replace(g,"");if(c){if(k.test(u)){s=k.exec(u),p=s[1],r="*"!==p&&p!==b&&p!==q;continue}if(r)continue;l.test(u)&&(s=l.exec(u),d(i+s[1]))}var v=u.match(m);if(v&&3==v.length){var w=v[2].replace(n,function(a,b){return unescape("%u"+"0000".slice(b.length)+b)});e[v[1]]=f(w)}}}}function d(a){h(a,function(a){c(a,!1)},null,!1)}var e=[],g=/^\s*|\s*$/,j=/^\s*#|^\s*$/,k=/^\s*\[(.*)\]\s*$/,l=/^\s*@import\s+url\((.*)\)\s*$/i,m=/^([^=\s]*)\s*=\s*(.+)$/,n=/\\u([0-9a-fA-F]{1,4})/g,o=/[^\\]\\$/;return c(a,!0),e}function h(a,b,d,e){b=b||function(){},d=d||function(){c(a+" not found.")};var f=new XMLHttpRequest;f.open("GET",a,e),f.overrideMimeType&&f.overrideMimeType("text/plain; charset=utf-8"),f.onreadystatechange=function(){4==f.readyState&&(200==f.status||0===f.status?b(f.responseText):d())},f.onerror=d,f.ontimeout=d;try{f.send(null)}catch(g){d()}}var i=a.replace(/\/[^\/]*$/,"/");h(a,function(b){if(/\.json$/.test(a))y=JSON.parse(b);else{var c=g(b);for(var e in c){var f,h,i,j=e.lastIndexOf(".");j>0?(f=e.slice(0,j),h=e.slice(j+1),j=f.lastIndexOf("."),j>0&&(i=f.substr(j+1),C.indexOf(i)>-1&&(f=f.substr(0,j),h=i+"."+h))):(j=e.lastIndexOf("["),j>0?(f=e.slice(0,j),h="_"+e.slice(j)):(f=e,h="_")),y[f]||(y[f]={}),y[f][h]=c[e]}}d&&d()},e,E)}function l(a,g){function h(){g&&(n?l.length&&(l=u(l)):l=v()),B="complete",j(a),d(l,a)}function i(a){var d=/\{\{\s*locale\s*\}\}/,e=function(b,e,f){var g=unescape(a.href).replace(d,b);k(g,b,e,function(){c(g+" not found."),f()})};this.load=function(c,f,g){g=g||function(){},e(c,f,function(){d.test(unescape(a.href))&&D!=c?(b("Trying the fallback locale: "+D),e(D,f,g)):g()})}}m(),B="loading",z=a;var l=[],n=f(a);n&&(y=n,g&&(l=v()));var o=e(),p=o.length;if(p)for(var q=function(){--p<=0&&h()},r=0,s=p;s>r;r++){var t=new i(o[r]);t.load(a,q,q)}else b("no resource to load, early way out"),g=!1,h()}function m(){y={},z=""}function n(a){function b(a,b){return-1!==b.indexOf(a)}function d(a,b,c){return a>=b&&c>=a}var e={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3},f={0:function(){return"other"},1:function(a){return d(a%100,3,10)?"few":0===a?"zero":d(a%100,11,99)?"many":2==a?"two":1==a?"one":"other"},2:function(a){return 0!==a&&a%10===0?"many":2==a?"two":1==a?"one":"other"},3:function(a){return 1==a?"one":"other"},4:function(a){return d(a,0,1)?"one":"other"},5:function(a){return d(a,0,2)&&2!=a?"one":"other"},6:function(a){return 0===a?"zero":a%10==1&&a%100!=11?"one":"other"},7:function(a){return 2==a?"two":1==a?"one":"other"},8:function(a){return d(a,3,6)?"few":d(a,7,10)?"many":2==a?"two":1==a?"one":"other"},9:function(a){return 0===a||1!=a&&d(a%100,1,19)?"few":1==a?"one":"other"},10:function(a){return d(a%10,2,9)&&!d(a%100,11,19)?"few":a%10!=1||d(a%100,11,19)?"other":"one"},11:function(a){return d(a%10,2,4)&&!d(a%100,12,14)?"few":a%10===0||d(a%10,5,9)||d(a%100,11,14)?"many":a%10==1&&a%100!=11?"one":"other"},12:function(a){return d(a,2,4)?"few":1==a?"one":"other"},13:function(a){return d(a%10,2,4)&&!d(a%100,12,14)?"few":1!=a&&d(a%10,0,1)||d(a%10,5,9)||d(a%100,12,14)?"many":1==a?"one":"other"},14:function(a){return d(a%100,3,4)?"few":a%100==2?"two":a%100==1?"one":"other"},15:function(a){return 0===a||d(a%100,2,10)?"few":d(a%100,11,19)?"many":1==a?"one":"other"},16:function(a){return a%10==1&&11!=a?"one":"other"},17:function(a){return 3==a?"few":0===a?"zero":6==a?"many":2==a?"two":1==a?"one":"other"},18:function(a){return 0===a?"zero":d(a,0,2)&&0!==a&&2!=a?"one":"other"},19:function(a){return d(a,2,10)?"few":d(a,0,1)?"one":"other"},20:function(a){return!d(a%10,3,4)&&a%10!=9||d(a%100,10,19)||d(a%100,70,79)||d(a%100,90,99)?a%1e6===0&&0!==a?"many":a%10!=2||b(a%100,[12,72,92])?a%10!=1||b(a%100,[11,71,91])?"other":"one":"two":"few"},21:function(a){return 0===a?"zero":1==a?"one":"other"},22:function(a){return d(a,0,1)||d(a,11,99)?"one":"other"},23:function(a){return d(a%10,1,2)||a%20===0?"one":"other"},24:function(a){return d(a,3,10)||d(a,13,19)?"few":b(a,[2,12])?"two":b(a,[1,11])?"one":"other"}},g=e[a.replace(/-.*$/,"")];return g in f?f[g]:(c("plural form unknown for ["+a+"]"),function(){return"other"})}function o(a,b){var c=y[a];if(!c)return null;var d={};for(var e in c){var f=c[e];f=r(f,b,a,e),f=s(f,b,a),d[e]=f}return d}function p(a){for(var b=[],c=H.exec(a);c&&c.length>=2;)b.push({name:c[1],subst:c[0]}),a=a.substr(c.index+c[0].length),c=H.exec(a);return b}function q(a){function b(a){for(var b=p(a),d=0;d<b.length;d++){var e=b[d].name;e in y&&(c[e]=y[e])}}if(!a)return JSON.parse(JSON.stringify(y));for(var c={},d=g(a),e=0,f=d.length;f>e;e++){var i=h(d[e]).id,j=y[i];if(i&&j){c[i]=j;for(var k in j){var l=j[k];if(b(l),I.test(l))for(var m=0;m<G.length;m++){var n=i+"["+G[m]+"]";n in y&&(c[n]=y[n],b(y[n]))}}}}return c}function r(a,b,c,d){var e=I.exec(a);if(!e||!e.length)return a;var f,g=e[1],h=e[2];if(b&&h in b?f=b[h]:h in y&&(f=y[h]),g in A){var i=A[g];a=i(a,f,c,d)}return a}function s(a,c,d){for(var e=p(a),f=0;f<e.length;f++){var g,h=e[f].name;if(c&&h in c)g=c[h];else{if(!(h in y))return b("argument {{"+h+"}} for #"+d+" is undefined."),a;g=y[h]._}a=a.replace(e[f].subst,g)}return a}function t(a){var b=h(a);if(!b.id)return!0;var c=o(b.id,b.args);if(!c)return!1;for(var d in c)if("_"===d)i(a,c._);else{var e=d.lastIndexOf("."),f=d.substr(0,e);C.indexOf(f)>-1?a[f][d.substr(e+1)]=c[d]:"ariaLabel"===d?a.setAttribute("aria-label",c[d]):a[d]=c[d]}return!0}function u(a){for(var b=[],c=0,d=a.length;d>c;c++)t(a[c])||b.push(a[c]);return b}function v(a){a=a||document.documentElement;var b=u(g(a));return t(a)||b.push(a),b}function w(a,b,c){if(a){if(!b)return a.removeAttribute("data-l10n-id"),a.removeAttribute("data-l10n-args"),void i(a,"");a.setAttribute("data-l10n-id",b),c&&"object"==typeof c?a.setAttribute("data-l10n-args",JSON.stringify(c)):a.removeAttribute("data-l10n-args"),"complete"===B&&t(a)}}function x(){D=document.documentElement.lang||D,B="interactive",b("loading ["+navigator.language+"] resources, "+(E?"asynchronously.":"synchronously."));var a=document.documentElement.lang!==navigator.language;l(navigator.language,a)}var y={},z="",A={},B="loading",C=["style","dataset"],D="en-US",E=!0,F=1,G=["zero","one","two","few","many","other"];A.plural=function(a,b,c,d){var e=parseFloat(b);if(isNaN(e))return a;var f=y[c];if(!f)return a;A._pluralRules||(A._pluralRules=n(z));var g="["+A._pluralRules(e)+"]";return 0===e&&d+"[zero]"in f?a=f[d+"[zero]"]:1==e&&d+"[one]"in f?a=f[d+"[one]"]:2==e&&d+"[two]"in f?a=f[d+"[two]"]:d+g in f?a=f[d+g]:d+"[other]"in f&&(a=f[d+"[other]"]),a};var H=/\{\{\s*(.+?)\s*\}\}/,I=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/;"undefined"!=typeof document&&("complete"===document.readyState||"interactive"===document.readyState?a.setTimeout(x):document.addEventListener("DOMContentLoaded",x)),"mozSettings"in navigator&&navigator.mozSettings&&navigator.mozSettings.addObserver("language.current",function(a){l(a.settingValue,!0)}),navigator.mozL10n={get:function(a,b){var d=o(a,b);return d?d._:(c("#"+a+" is undefined."),"")},get language(){return{get code(){return z},set code(a){l(a,!0)},get direction(){var a=["ar","he","fa","ps","ur"];return a.indexOf(z)>=0?"rtl":"ltr"}}},translate:v,localize:w,getDictionary:q,get readyState(){return B},ready:function(b){b&&("complete"==B?a.setTimeout(b):a.addEventListener("localized",b))}},b("library loaded.")}(this),function(){var a=window.applicationCache;if(a){a.onupdateready=function(){confirm("The app has been updated. Do you want to download the latest files? \nOtherwise they will be updated at the next reload.")&&location.reload(!0)};var b=document.querySelector("#online-status");b&&(a.onerror=function(){b.className="offline",b.title="Offline"})}}(),function(){var a=document.querySelector("#pick-image");a&&(a.onclick=function(){var a=new MozActivity({name:"pick",data:{type:["image/png","image/jpg","image/jpeg"],nocrop:!0}});a.onsuccess=function(){var a=document.createElement("img");a.src=window.URL.createObjectURL(this.result.blob);var b=document.querySelector("#image-presenter");b.appendChild(a),b.style.display="block"},a.onerror=function(){console.log("Can't view the image")}});var b=document.querySelector("#pick-anything");b&&(b.onclick=function(){var a=new MozActivity({name:"pick"});a.onsuccess=function(){var a=document.createElement("img");if(-1!=this.result.blob.type.indexOf("image")){a.src=window.URL.createObjectURL(this.result.blob);var b=document.querySelector("#image-presenter");b.appendChild(a),b.style.display="block"}},a.onerror=function(){console.log("An error occurred")}});var c=document.querySelector("#record");c&&(c.onclick=function(){var a=new MozActivity({name:"record"});a.onsuccess=function(){var a=document.createElement("img");a.src=window.URL.createObjectURL(this.result.blob);var b=document.querySelector("#image-presenter");b.appendChild(a),b.style.display="block"},a.onerror=function(){alert("No taken picture returned")}});var d=document.querySelector("#dial");d&&(d.onclick=function(){new MozActivity({name:"dial",data:{number:"+46777888999"}})});var e=document.querySelector("#send-sms");e&&(e.onclick=function(){new MozActivity({name:"new",data:{type:"websms/sms",number:"+46777888999"}})});var f=document.querySelector("#add-contact");f&&(f.onclick=function(){new MozActivity({name:"new",data:{type:"webcontacts/contact",params:{givenName:"Robert",lastName:"Nyman",tel:"+44789",email:"robert@mozilla.com",address:"San Francisco",note:"This is a note",company:"Mozilla"}}})});var g=document.querySelector("#share");g&&(g.onclick=function(){new MozActivity({name:"share",data:{number:1,url:"http://robertnyman.com"}})});var h=document.querySelector("#share-image"),i=document.querySelector("#image-to-share");h&&i&&(h.onclick=function(){if(i.naturalWidth>0){var a=document.createElement("canvas");a.width=i.width,a.height=i.height;var b=a.getContext("2d");b.drawImage(i,0,0),a.toBlob(function(a){new MozActivity({name:"share",data:{type:"image/*",number:1,blobs:[a]}})})}else alert("Image failed to load, can't be shared")});var j=document.querySelector("#view-url");j&&(j.onclick=function(){new MozActivity({name:"view",data:{type:"url",url:"http://robertnyman.com"}})});var k=document.querySelector("#compose-email");k&&(k.onclick=function(){new MozActivity({name:"new",data:{type:"mail",url:"mailto:example@example.org"}})});var l=document.querySelector("#save-bookmark");l&&(l.onclick=function(){new MozActivity({name:"save-bookmark",data:{type:"url",url:"http://robertnyman.com",name:"Robert's talk",icon:"http://robertnyman.com/favicon.png"}})});var m=document.querySelector("#open-video");m&&(m.onclick=function(){new MozActivity({name:"open",data:{type:["video/webm","video/mp4","video/3gpp","video/youtube"],url:"http://v2v.cc/~j/theora_testsuite/320x240.ogg"}})});var n=document.querySelector("#add-notification");n&&(n.onclick=function(){if("Notification"in window)"denied"!==Notification.permission&&Notification.requestPermission(function(a){"permission"in Notification||(Notification.permission=a)}),"granted"===Notification.permission&&new Notification("See this",{body:"This is a notification"});else{var a=navigator.mozNotification.createNotification("See this","This is a notification");a.show()}});var o=document.querySelector("#lock-orientation");o&&(o.onclick=function(){var a=screen.mozLockOrientation("portrait");a&&alert("Orientation locked to portrait")});var p=document.querySelector("#vibrate");p&&(p.onclick=function(){navigator.vibrate(2e3)});var q=document.querySelector("#check-connection"),r=document.querySelector("#connection-display");q&&r&&(q.onclick=function(){var a=window.navigator.mozConnection,b="<strong>Connected:</strong> "+a.bandwidth,c="<strong>Metered:</strong> "+a.metered;r.innerHTML="<h4>Result from Check connection</h4>"+b+"<br>"+c,r.style.display="block"});var s=document.querySelector("#check-battery"),t=document.querySelector("#battery-display");s&&t&&(s.onclick=function(){var a,b=navigator.battery,c=Math.round(100*b.level)+"%",d=b.charging,e=parseInt(b.chargingTime/60,10),f=parseInt(b.dischargingTime/60,10);a="<h4>Result from Check battery</h4><strong>Battery level:</strong> "+c+"<br>",a+="<strong>Battery charging:</strong> "+d+"<br>",a+="<strong>Battery charging time:</strong> "+e+"<br>",a+="<strong>Battery discharging time:</strong> "+f,t.innerHTML=a,t.style.display="block"});var u=document.querySelector("#geolocation"),v=document.querySelector("#geolocation-display");u&&v&&(u.onclick=function(){navigator.geolocation.getCurrentPosition(function(a){v.innerHTML="<strong>Latitude:</strong> "+a.coords.latitude+", <strong>Longitude:</strong> "+a.coords.longitude,v.style.display="block"},function(){v.innerHTML="Failed to get your current location",v.style.display="block"})});var w=document.querySelector("#ambient-light"),x=document.querySelector("#ambient-light-display");w&&x&&(w.onclick=function(){x.style.display="block",window.ondevicelight=function(a){var b="<strong>Ambient light: </strong>"+a.value+" lux";x.innerHTML=b}});var y=document.querySelector("#proximity"),z=document.querySelector("#proximity-display");y&&z&&(y.onclick=function(){z.style.display="block",window.ondeviceproximity=function(a){var b="<strong>Proximity: </strong>"+a.value+" cm<br>";b+="<strong>Min value supported: </strong>"+a.min+" cm<br>",b+="<strong>Max value supported: </strong>"+a.max+" cm",z.innerHTML=b}});var A=document.querySelector("#user-proximity"),B=document.querySelector("#user-proximity-display");A&&B&&(A.onclick=function(){B.style.display="block",window.onuserproximity=function(a){var b="<strong>User proximity - near: </strong>"+a.near+"<br>";B.innerHTML=b}});var C=document.querySelector("#device-orientation"),D=document.querySelector("#device-orientation-display");C&&D&&(C.onclick=function(){D.style.display="block",window.ondeviceorientation=function(a){var b=a.beta>45&&a.beta<135?"top":a.beta<-45&&a.beta>-135?"bottom":a.gamma>45?"right":a.gamma<-45?"left":"flat",c="<strong>Absolute: </strong>"+a.absolute+"<br><strong>Alpha: </strong>"+a.alpha+"<br><strong>Beta: </strong>"+a.beta+"<br><strong>Gamma: </strong>"+a.gamma+"<br><strong>Device orientation: </strong>"+b;D.innerHTML=c}});var E=document.querySelector("#log-visibility"),F=document.querySelector("#log-visibility-display");E&&F&&(E.onclick=function(){F.style.display="block",F.innerHTML="I have focus!<br>",document.addEventListener("visibilitychange",function(){document.hidden?(console.log("Firefox OS Boilerplate App is hidden"),F.innerHTML+="Now I'm in the background<br>"):(console.log("Firefox OS Boilerplate App has focus"),F.innerHTML+="I have focus!<br>")})});var G=document.querySelector("#cross-domain-xhr"),H=document.querySelector("#cross-domain-xhr-display");G&&H&&(G.onclick=function(){var a=new XMLHttpRequest({mozSystem:!0});a.open("GET","http://robnyman.github.com/Firefox-OS-Boilerplate-App/README.md",!0),a.onreadystatechange=function(){200===a.status&&4===a.readyState&&(H.innerHTML="<h4>Result from Cross-domain XHR</h4>"+a.response,H.style.display="block")},a.onerror=function(){H.innerHTML="<h4>Result from Cross-domain XHR</h4><p>Cross-domain XHR failed</p>",H.style.display="block"},a.send()});var I=document.querySelector("#device-storage-pictures"),J=document.querySelector("#device-storage-pictures-display");I&&J&&(I.onclick=function(){var a=navigator.getDeviceStorage("pictures"),b=a.enumerate();J.innerHTML="<h4>Result from deviceStorage - pictures</h4>",b.onsuccess=function(){b.result||(J.innerHTML="No files");var a,c=b.result;a="<strong>"+c.name+":</strong> "+parseInt(c.size/1024,10)+"kb<br>",a+="<p><img src='"+window.URL.createObjectURL(c)+"' alt=''></p>",J.innerHTML+=a,J.style.display="block"},b.onerror=function(){console.log("Error"),J.innerHTML="<h4>Result from deviceStorage - pictures</h4><p>deviceStorage failed</p>",J.style.display="block"}});var K=document.querySelector("#get-all-contacts"),L=document.querySelector("#get-all-contacts-display");K&&L&&(K.onclick=function(){var a=window.navigator.mozContacts.getAll({});L.style.display="block",a.onsuccess=function(){var b=a.result;b&&(L.innerHTML+=b.givenName+" "+b.familyName+"<br>",a.continue())},a.onerror=function(){L.innerHTML+="Error"}});var M=null,N=document.querySelector("#keep-screen-on");N&&(N.onclick=function(){M?(M.unlock(),M=null,N.innerHTML="Keep screen on"):(M=window.navigator.requestWakeLock("screen"),N.innerHTML="Remove the lock")})}();